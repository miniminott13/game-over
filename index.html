<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Behavior Chart</title>
  <link rel="icon" type="image/png" href="photo.png" />
  <link rel="apple-touch-icon" href="photo.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Press Start 2P', cursive;
      text-align: center;
      margin: 0;
      padding: 0;
      background-color: #001f3f;
      color: white;
    }
    h1 {
      background-color: #003366;
      padding: 20px;
      color: white;
    }
    .class-section {
      margin-top: 30px;
    }
    .class-name {
      font-size: 1.5em;
      margin-bottom: 20px;
      color: #ffcc00;
    }
    .students-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-gap: 15px;
      justify-items: center;
      margin-top: 20px;
      padding: 20px;
    }
    .student {
      background-color: #00274d;
      padding: 15px;
      border-radius: 10px;
      width: 150px;
    }
    .student-name {
      display: block;
      margin-top: 10px;
      font-size: 0.8em;
    }
    .life-bar {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }
    .life {
      width: 30px;
      height: 30px;
      margin: 5px;
      background-size: cover;
      background-image: url("photo.png");
      animation: bounce 1s infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .life.deducted {
      opacity: 0.3;
    }
    .game-over {
      background-color: grey;
    }
    .absent {
      background-color: #808080;
    }
    .button, .reset-button {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #ff4136;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 0.7em;
      border-radius: 5px;
    }
    .button:active, .reset-button:active {
      background-color: #d32f2f;
    }
    #students-container {
      margin-top: 30px;
      display: none;
    }
    select {
      padding: 5px;
      font-size: 1em;
      background-color: #00274d;
      color: white;
      border: 1px solid white;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>Behavior Chart</h1>

  <label for="class-select">Select Class:</label>
  <select id="class-select">
    <option value="">--Choose a class--</option>
  </select>

  <div id="students-container" class="students-grid"></div>

  <script>
    // Default classes data with original student names and lives
    const defaultClasses = [
      {
        className: 'MAG1',
        students: [
          { name: 'Hyun Kang', lives: 3, absent: false },
          { name: 'William Baek', lives: 3, absent: false },
          { name: 'Yuju Min', lives: 3, absent: false },
          { name: 'Emma Kim', lives: 3, absent: false },
          { name: 'Ella Ha', lives: 3, absent: false },
          { name: 'Shawn Oh', lives: 3, absent: false },
          { name: 'Min Kim', lives: 3, absent: false },
          { name: 'Jane Lee', lives: 3, absent: false },
          { name: 'Evan Jung', lives: 3, absent: false },
          { name: 'Jenny Yoon', lives: 3, absent: false },
          { name: 'Johann Lee', lives: 3, absent: false },
          { name: 'Emily Joo', lives: 3, absent: false }
        ]
      },
      {
        className: 'S1-R',
        students: [
          { name: 'Irene Song', lives: 3, absent: false },
          { name: 'Roy Myung', lives: 3, absent: false },
          { name: 'Suho Park', lives: 3, absent: false },
          { name: 'Thomas Hong', lives: 3, absent: false },
          { name: 'Estelle Jung', lives: 3, absent: false },
          { name: 'Allie Lee', lives: 3, absent: false },
          { name: 'Irene Jung', lives: 3, absent: false },
          { name: 'Sally Yang', lives: 3, absent: false },
          { name: 'Kevin Park', lives: 3, absent: false },
          { name: 'Evelyn Joo', lives: 3, absent: false },
          { name: 'Jordan Oh', lives: 3, absent: false },
          { name: 'Jenny Kim', lives: 3, absent: false }
        ]
      }
    ];

    // Function to load classes data from localStorage or use default
    function loadClasses() {
      const savedData = localStorage.getItem("classesData");
      return savedData ? JSON.parse(savedData) : defaultClasses;
    }

    // Function to save classes data to localStorage
    function saveClasses(data) {
      localStorage.setItem("classesData", JSON.stringify(data));
    }

    // Use the loaded data as our classes array
    let classes = loadClasses();

    function populateClassDropdown() {
      const selectElement = document.getElementById("class-select");
      classes.forEach((classData, index) => {
        const option = document.createElement("option");
        option.value = index;
        option.textContent = classData.className;
        selectElement.appendChild(option);
      });
    }

    function showStudents(classIndex) {
      const studentsContainer = document.getElementById("students-container");
      studentsContainer.innerHTML = ''; // Clear any previous students

      const classData = classes[classIndex];
      classData.students.forEach((student, studentIndex) => {
        const studentDiv = document.createElement('div');
        studentDiv.classList.add('student');
        studentDiv.classList.add(student.lives === 0 ? 'game-over' : student.absent ? 'absent' : '');
        studentDiv.innerHTML = `<span class="student-name">${student.name}</span>`;

        const lifeBar = document.createElement('div');
        lifeBar.classList.add('life-bar');
        for (let i = 1; i <= 3; i++) {
          const life = document.createElement('div');
          life.classList.add('life');
          life.id = `life-${classIndex}-${studentIndex}-${i}`;
          if (i > student.lives) {
            life.classList.add('deducted');
          }
          lifeBar.appendChild(life);
        }
        studentDiv.appendChild(lifeBar);

        const deductButton = document.createElement('button');
        deductButton.classList.add('button');
        deductButton.textContent = `Deduct Life`;
        deductButton.onclick = () => deductLife(classIndex, studentIndex);

        const addButton = document.createElement('button');
        addButton.classList.add('button');
        addButton.textContent = `Add Life`;
        addButton.onclick = () => addLife(classIndex, studentIndex);

        studentDiv.appendChild(deductButton);
        studentDiv.appendChild(addButton);

        studentsContainer.appendChild(studentDiv);
      });

      studentsContainer.style.display = 'grid'; // Show the students container
    }

    function deductLife(classIndex, studentIndex) {
      const student = classes[classIndex].students[studentIndex];
      if (student.lives > 0) {
        student.lives--;
        updateLifeBar(classIndex, studentIndex);
        saveClasses(classes);
      } else {
        alert(`No lives left for ${student.name}`);
      }
    }

    function addLife(classIndex, studentIndex) {
      const student = classes[classIndex].students[studentIndex];
      if (student.lives < 3) {
        student.lives++;
        updateLifeBar(classIndex, studentIndex);
        saveClasses(classes);
      } else {
        alert(`${student.name} already has full lives.`);
      }
    }

    function updateLifeBar(classIndex, studentIndex) {
      const student = classes[classIndex].students[studentIndex];
      for (let i = 1; i <= 3; i++) {
        const life = document.getElementById(`life-${classIndex}-${studentIndex}-${i}`);
        if (i > student.lives) {
          life.classList.add('deducted');
        } else {
          life.classList.remove('deducted');
        }
      }
    }

    // Populate the class dropdown
    populateClassDropdown();

    // Event listener to handle class selection
    document.getElementById('class-select').addEventListener('change', function(event) {
      const classIndex = event.target.value;
      if (classIndex) {
        showStudents(classIndex);
      } else {
        document.getElementById("students-container").style.display = 'none'; // Hide student grid if no class selected
      }
    });
  </script>
</body>
</html>
